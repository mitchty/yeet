# If stdin exists we kinda have to be a login shell
if [ -t 0 ]; then
  export CARGO_TARGET_DIR=$(uniq_cache rust)
else
  export CARGO_TARGET_DIR=$(uniq_cache rust-analyzer)
fi
export PREFIX=${CARGO_TARGET_DIR}

export PATH=$PATH:${CARGO_TARGET_DIR}/debug:${CARGO_TARGET_DIR}/release:$(pwd)/result/bin:${PREFIX}/debug:${PREFIX}/release
export RUST_BACKTRACE=full

has nix && use flake

[ -e local.env ] && . local.env

# Watch this file and reload direnv on changes, .envrc requires me to reload
# anyway so yeah... (note I could make it automagic but prefer not to)
watch_file flake.nix
